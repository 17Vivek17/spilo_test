name: Build spilo image

on:
  workflow_dispatch:
    inputs :
      version : 
        description : spilo release
        default : "3.0-p1"
        type : "string"
       
jobs:

  job1:
    runs-on : ubuntu-latest
    steps:
      - name: spilo release
        run: |
          echo The version is ${{ inputs.version }}
          strategy:
      matrix:
        node-version: [10.x, 12.x, 14.x, 15.x]
        
      - uses: actions/checkout@v3
        name: spilo checkout
        with:
          repository: zalando/spilo
          ref: ${{ inputs.version }}
          
      - name: Use Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '12.x'
          
      - name : build spilo docker image
        uses : docker/build-push-action@v2.0.0
        with :
         file : extra/spilo/postgres-appliance/
         build-args: |
           TIMESCALEDB_APACHE_ONLY="false"
           PGOLDVERSIONS="13"
